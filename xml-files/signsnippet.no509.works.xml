<foobar>
<!-- 
based on
https://tribunet.hacienda.go.cr/docs/esquemas/2016/v4.2/ANEXOS%20Y%20ESTRUCTURAS_V4.2.pdf  
- removed all <*Value> values
- removed 509 cert stuff
- signable with xmlsec
-->
<ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
 <ds:SignedInfo>
 <ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
 <ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"/>
 <ds:Reference Id="r-id-1" Type="" URI="">
 <ds:Transforms>
 <ds:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
 <ds:XPath>not(ancestor-or-self::ds:Signature)</ds:XPath>
 </ds:Transform>
 <ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
 </ds:Transforms>
 <ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/>
 <ds:DigestValue></ds:DigestValue>
 </ds:Reference>
 <ds:Reference Type="http://uri.etsi.org/01903#SignedProperties">
 <ds:Transforms>
 <ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
 </ds:Transforms>
 <ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/>
 <ds:DigestValue></ds:DigestValue>
 </ds:Reference>
 </ds:SignedInfo>
 <ds:SignatureValue></ds:SignatureValue>
 <ds:KeyInfo>
 </ds:KeyInfo>
 <ds:Object>
 <xades:QualifyingProperties xmlns:xades="http://uri.etsi.org/01903/v1.3.2#" Target="#ide34ffbff277e8d1432e864436aa11882">
 <xades:SignedProperties>
 <xades:SignedSignatureProperties>
 <xades:SigningTime>2016-11-25T16:35:06Z</xades:SigningTime>
 <xades:SigningCertificate>
 <xades:Cert>
 <xades:CertDigest>
 <ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
<ds:DigestValue></ds:DigestValue>
 </xades:CertDigest>
<xades:IssuerSerial>
 <ds:X509IssuerName>CN=CA SINPE - PERSONA FISICA,OU=DIVISION DE SERVICIOS
FINANCIEROS,O=BANCO CENTRAL DE COSTA RICA,C=CR,2.5.4.5=#130c342d3030302d303034303137</ds:X509IssuerName>
 <ds:X509SerialNumber>207422209224813750547132</ds:X509SerialNumber>
 </xades:IssuerSerial>
 </xades:Cert>
 </xades:SigningCertificate>
<xades:SignaturePolicyIdentifier>
 <xades:SignaturePolicyId>
 <xades:SigPolicyId>
 <xades:Identifier>https://tribunet.hacienda.go.cr/docs/esquemas/2016/v4.1/Resolucion_Comprobantes_Electronicos_DGT-R-48-2016.pdf</xades:Identifier>
 </xades:SigPolicyId>
<xades:SigPolicyHash>
 <ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/>
<ds:DigestValue></ds:DigestValue>
 </xades:SigPolicyHash>
 </xades:SignaturePolicyId>
 </xades:SignaturePolicyIdentifier>
 </xades:SignedSignatureProperties>
 <xades:SignedDataObjectProperties>
 <xades:DataObjectFormat ObjectReference="#r-id-1">
 <xades:MimeType>application/octet-stream</xades:MimeType>
 </xades:DataObjectFormat>
 </xades:SignedDataObjectProperties>
 </xades:SignedProperties>
 </xades:QualifyingProperties>
 </ds:Object>
</ds:Signature>
</foobar>

